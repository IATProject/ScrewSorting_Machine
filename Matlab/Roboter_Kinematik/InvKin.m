%close all
clear

z0 = 58;
l1 = 80;
l2 = 80;
x = 149;
z = 0;

phi1_rad(1) = atan2((z0^2*x - 2*z0*x*z + l1^2*x - l2^2*x + x^3 + x*z^2 + sqrt(-z0^6 + 6*z0^5*z + 2*z0^4*l1^2 + 2*z0^4*l2^2 - 2*z0^4*x^2 - 15*z0^4*z^2 - 8*z0^3*l1^2*z - 8*z0^3*l2^2*z + 8*z0^3*x^2*z + 20*z0^3*z^3 - z0^2*l1^4 + 2*z0^2*l1^2*l2^2 + 2*z0^2*l1^2*x^2 + 12*z0^2*l1^2*z^2 - z0^2*l2^4 + 2*z0^2*l2^2*x^2 + 12*z0^2*l2^2*z^2 - z0^2*x^4 - 12*z0^2*x^2*z^2 - 15*z0^2*z^4 + 2*z0*l1^4*z - 4*z0*l1^2*l2^2*z - 4*z0*l1^2*x^2*z - 8*z0*l1^2*z^3 + 2*z0*l2^4*z - 4*z0*l2^2*x^2*z - 8*z0*l2^2*z^3 + 2*z0*x^4*z + 8*z0*x^2*z^3 + 6*z0*z^5 - l1^4*z^2 + 2*l1^2*l2^2*z^2 + 2*l1^2*x^2*z^2 + 2*l1^2*z^4 - l2^4*z^2 + 2*l2^2*x^2*z^2 + 2*l2^2*z^4 - x^4*z^2 - 2*x^2*z^4 - z^6))/(z0^2 - 2*z0*z + x^2 + z^2), (x*(z0^2*x - 2*z0*x*z + l1^2*x - l2^2*x + x^3 + x*z^2 + sqrt(-z0^6 + 6*z0^5*z + 2*z0^4*l1^2 + 2*z0^4*l2^2 - 2*z0^4*x^2 - 15*z0^4*z^2 - 8*z0^3*l1^2*z - 8*z0^3*l2^2*z + 8*z0^3*x^2*z + 20*z0^3*z^3 - z0^2*l1^4 + 2*z0^2*l1^2*l2^2 + 2*z0^2*l1^2*x^2 + 12*z0^2*l1^2*z^2 - z0^2*l2^4 + 2*z0^2*l2^2*x^2 + 12*z0^2*l2^2*z^2 - z0^2*x^4 - 12*z0^2*x^2*z^2 - 15*z0^2*z^4 + 2*z0*l1^4*z - 4*z0*l1^2*l2^2*z - 4*z0*l1^2*x^2*z - 8*z0*l1^2*z^3 + 2*z0*l2^4*z - 4*z0*l2^2*x^2*z - 8*z0*l2^2*z^3 + 2*z0*x^4*z + 8*z0*x^2*z^3 + 6*z0*z^5 - l1^4*z^2 + 2*l1^2*l2^2*z^2 + 2*l1^2*x^2*z^2 + 2*l1^2*z^4 - l2^4*z^2 + 2*l2^2*x^2*z^2 + 2*l2^2*z^4 - x^4*z^2 - 2*x^2*z^4 - z^6))/(z0^2 - 2*z0*z + x^2 + z^2) - z0^2 + 2*z0*z - l1^2 + l2^2 - x^2 - z^2)/(z0 - z));
%phi1_rad(2) = atan2(-(-l0^2*x2 + 2*l0*x2*y2 - l1^2*x2 + l2^2*x2 - x2^3 - x2*y2^2 + sqrt(-l0^6 + 6*l0^5*y2 + 2*l0^4*l1^2 + 2*l0^4*l2^2 - 2*l0^4*x2^2 - 15*l0^4*y2^2 - 8*l0^3*l1^2*y2 - 8*l0^3*l2^2*y2 + 8*l0^3*x2^2*y2 + 20*l0^3*y2^3 - l0^2*l1^4 + 2*l0^2*l1^2*l2^2 + 2*l0^2*l1^2*x2^2 + 12*l0^2*l1^2*y2^2 - l0^2*l2^4 + 2*l0^2*l2^2*x2^2 + 12*l0^2*l2^2*y2^2 - l0^2*x2^4 - 12*l0^2*x2^2*y2^2 - 15*l0^2*y2^4 + 2*l0*l1^4*y2 - 4*l0*l1^2*l2^2*y2 - 4*l0*l1^2*x2^2*y2 - 8*l0*l1^2*y2^3 + 2*l0*l2^4*y2 - 4*l0*l2^2*x2^2*y2 - 8*l0*l2^2*y2^3 + 2*l0*x2^4*y2 + 8*l0*x2^2*y2^3 + 6*l0*y2^5 - l1^4*y2^2 + 2*l1^2*l2^2*y2^2 + 2*l1^2*x2^2*y2^2 + 2*l1^2*y2^4 - l2^4*y2^2 + 2*l2^2*x2^2*y2^2 + 2*l2^2*y2^4 - x2^4*y2^2 - 2*x2^2*y2^4 - y2^6))/(2*(l0^2 - 2*l0*y2 + x2^2 + y2^2)), (-x2*(-l0^2*x2 + 2*l0*x2*y2 - l1^2*x2 + l2^2*x2 - x2^3 - x2*y2^2 + sqrt(-l0^6 + 6*l0^5*y2 + 2*l0^4*l1^2 + 2*l0^4*l2^2 - 2*l0^4*x2^2 - 15*l0^4*y2^2 - 8*l0^3*l1^2*y2 - 8*l0^3*l2^2*y2 + 8*l0^3*x2^2*y2 + 20*l0^3*y2^3 - l0^2*l1^4 + 2*l0^2*l1^2*l2^2 + 2*l0^2*l1^2*x2^2 + 12*l0^2*l1^2*y2^2 - l0^2*l2^4 + 2*l0^2*l2^2*x2^2 + 12*l0^2*l2^2*y2^2 - l0^2*x2^4 - 12*l0^2*x2^2*y2^2 - 15*l0^2*y2^4 + 2*l0*l1^4*y2 - 4*l0*l1^2*l2^2*y2 - 4*l0*l1^2*x2^2*y2 - 8*l0*l1^2*y2^3 + 2*l0*l2^4*y2 - 4*l0*l2^2*x2^2*y2 - 8*l0*l2^2*y2^3 + 2*l0*x2^4*y2 + 8*l0*x2^2*y2^3 + 6*l0*y2^5 - l1^4*y2^2 + 2*l1^2*l2^2*y2^2 + 2*l1^2*x2^2*y2^2 + 2*l1^2*y2^4 - l2^4*y2^2 + 2*l2^2*x2^2*y2^2 + 2*l2^2*y2^4 - x2^4*y2^2 - 2*x2^2*y2^4 - y2^6))/(l0^2 - 2*l0*y2 + x2^2 + y2^2) - l0^2 + 2*l0*y2 - l1^2 + l2^2 - x2^2 - y2^2)/(2*(l0 - y2)));

phi2_rad(1) = atan2(-(z0^2*x - 2*z0*x*z + l1^2*x - l2^2*x + x^3 + x*z^2 + sqrt(-z0^6 + 6*z0^5*z + 2*z0^4*l1^2 + 2*z0^4*l2^2 - 2*z0^4*x^2 - 15*z0^4*z^2 - 8*z0^3*l1^2*z - 8*z0^3*l2^2*z + 8*z0^3*x^2*z + 20*z0^3*z^3 - z0^2*l1^4 + 2*z0^2*l1^2*l2^2 + 2*z0^2*l1^2*x^2 + 12*z0^2*l1^2*z^2 - z0^2*l2^4 + 2*z0^2*l2^2*x^2 + 12*z0^2*l2^2*z^2 - z0^2*x^4 - 12*z0^2*x^2*z^2 - 15*z0^2*z^4 + 2*z0*l1^4*z - 4*z0*l1^2*l2^2*z - 4*z0*l1^2*x^2*z - 8*z0*l1^2*z^3 + 2*z0*l2^4*z - 4*z0*l2^2*x^2*z - 8*z0*l2^2*z^3 + 2*z0*x^4*z + 8*z0*x^2*z^3 + 6*z0*z^5 - l1^4*z^2 + 2*l1^2*l2^2*z^2 + 2*l1^2*x^2*z^2 + 2*l1^2*z^4 - l2^4*z^2 + 2*l2^2*x^2*z^2 + 2*l2^2*z^4 - x^4*z^2 - 2*x^2*z^4 - z^6))/(2*(z0^2 - 2*z0*z + x^2 + z^2)) + x, (x*(z0^2*x - 2*z0*x*z + l1^2*x - l2^2*x + x^3 + x*z^2 + sqrt(-z0^6 + 6*z0^5*z + 2*z0^4*l1^2 + 2*z0^4*l2^2 - 2*z0^4*x^2 - 15*z0^4*z^2 - 8*z0^3*l1^2*z - 8*z0^3*l2^2*z + 8*z0^3*x^2*z + 20*z0^3*z^3 - z0^2*l1^4 + 2*z0^2*l1^2*l2^2 + 2*z0^2*l1^2*x^2 + 12*z0^2*l1^2*z^2 - z0^2*l2^4 + 2*z0^2*l2^2*x^2 + 12*z0^2*l2^2*z^2 - z0^2*x^4 - 12*z0^2*x^2*z^2 - 15*z0^2*z^4 + 2*z0*l1^4*z - 4*z0*l1^2*l2^2*z - 4*z0*l1^2*x^2*z - 8*z0*l1^2*z^3 + 2*z0*l2^4*z - 4*z0*l2^2*x^2*z - 8*z0*l2^2*z^3 + 2*z0*x^4*z + 8*z0*x^2*z^3 + 6*z0*z^5 - l1^4*z^2 + 2*l1^2*l2^2*z^2 + 2*l1^2*x^2*z^2 + 2*l1^2*z^4 - l2^4*z^2 + 2*l2^2*x^2*z^2 + 2*l2^2*z^4 - x^4*z^2 - 2*x^2*z^4 - z^6))/(z0^2 - 2*z0*z + x^2 + z^2) + z0^2 - 2*z0*z - l1^2 + l2^2 - x^2 + z^2)/(2*(z0 - z)));
%phi2_rad(2) = atan2((-l0^2*x2 + 2*l0*x2*y2 - l1^2*x2 + l2^2*x2 - x2^3 - x2*y2^2 + sqrt(-l0^6 + 6*l0^5*y2 + 2*l0^4*l1^2 + 2*l0^4*l2^2 - 2*l0^4*x2^2 - 15*l0^4*y2^2 - 8*l0^3*l1^2*y2 - 8*l0^3*l2^2*y2 + 8*l0^3*x2^2*y2 + 20*l0^3*y2^3 - l0^2*l1^4 + 2*l0^2*l1^2*l2^2 + 2*l0^2*l1^2*x2^2 + 12*l0^2*l1^2*y2^2 - l0^2*l2^4 + 2*l0^2*l2^2*x2^2 + 12*l0^2*l2^2*y2^2 - l0^2*x2^4 - 12*l0^2*x2^2*y2^2 - 15*l0^2*y2^4 + 2*l0*l1^4*y2 - 4*l0*l1^2*l2^2*y2 - 4*l0*l1^2*x2^2*y2 - 8*l0*l1^2*y2^3 + 2*l0*l2^4*y2 - 4*l0*l2^2*x2^2*y2 - 8*l0*l2^2*y2^3 + 2*l0*x2^4*y2 + 8*l0*x2^2*y2^3 + 6*l0*y2^5 - l1^4*y2^2 + 2*l1^2*l2^2*y2^2 + 2*l1^2*x2^2*y2^2 + 2*l1^2*y2^4 - l2^4*y2^2 + 2*l2^2*x2^2*y2^2 + 2*l2^2*y2^4 - x2^4*y2^2 - 2*x2^2*y2^4 - y2^6))/(2*(l0^2 - 2*l0*y2 + x2^2 + y2^2)) + x2, (-x2*(-l0^2*x2 + 2*l0*x2*y2 - l1^2*x2 + l2^2*x2 - x2^3 - x2*y2^2 + sqrt(-l0^6 + 6*l0^5*y2 + 2*l0^4*l1^2 + 2*l0^4*l2^2 - 2*l0^4*x2^2 - 15*l0^4*y2^2 - 8*l0^3*l1^2*y2 - 8*l0^3*l2^2*y2 + 8*l0^3*x2^2*y2 + 20*l0^3*y2^3 - l0^2*l1^4 + 2*l0^2*l1^2*l2^2 + 2*l0^2*l1^2*x2^2 + 12*l0^2*l1^2*y2^2 - l0^2*l2^4 + 2*l0^2*l2^2*x2^2 + 12*l0^2*l2^2*y2^2 - l0^2*x2^4 - 12*l0^2*x2^2*y2^2 - 15*l0^2*y2^4 + 2*l0*l1^4*y2 - 4*l0*l1^2*l2^2*y2 - 4*l0*l1^2*x2^2*y2 - 8*l0*l1^2*y2^3 + 2*l0*l2^4*y2 - 4*l0*l2^2*x2^2*y2 - 8*l0*l2^2*y2^3 + 2*l0*x2^4*y2 + 8*l0*x2^2*y2^3 + 6*l0*y2^5 - l1^4*y2^2 + 2*l1^2*l2^2*y2^2 + 2*l1^2*x2^2*y2^2 + 2*l1^2*y2^4 - l2^4*y2^2 + 2*l2^2*x2^2*y2^2 + 2*l2^2*y2^4 - x2^4*y2^2 - 2*x2^2*y2^4 - y2^6))/(l0^2 - 2*l0*y2 + x2^2 + y2^2) + l0^2 - 2*l0*y2 - l1^2 + l2^2 - x2^2 + y2^2)/(2*(l0 - y2)));

phi1_grad = phi1_rad*180/pi;
phi2_grad = phi2_rad*180/pi;

fig = figure(1);
clf(fig)

draw_kinematik(phi1_rad(1), phi2_rad(1), 1);
%draw_kinematik(phi1_rad(2), phi2_rad(2), 2);
%draw_kinematik(phi1_rad(1), phi2_rad(2), 3);
%draw_kinematik(phi1_rad(2), phi2_rad(1), 4);

%%

close all

z = 56;

f_1 = @(x2) 180/pi*atan2((z0^2*x2 - 2*z0*x2*z + l1^2*x2 - l2^2*x2 + x2^3 + x2*z^2 + sqrt(-z0^6 + 6*z0^5*z + 2*z0^4*l1^2 + 2*z0^4*l2^2 - 2*z0^4*x2^2 - 15*z0^4*z^2 - 8*z0^3*l1^2*z - 8*z0^3*l2^2*z + 8*z0^3*x2^2*z + 20*z0^3*z^3 - z0^2*l1^4 + 2*z0^2*l1^2*l2^2 + 2*z0^2*l1^2*x2^2 + 12*z0^2*l1^2*z^2 - z0^2*l2^4 + 2*z0^2*l2^2*x2^2 + 12*z0^2*l2^2*z^2 - z0^2*x2^4 - 12*z0^2*x2^2*z^2 - 15*z0^2*z^4 + 2*z0*l1^4*z - 4*z0*l1^2*l2^2*z - 4*z0*l1^2*x2^2*z - 8*z0*l1^2*z^3 + 2*z0*l2^4*z - 4*z0*l2^2*x2^2*z - 8*z0*l2^2*z^3 + 2*z0*x2^4*z + 8*z0*x2^2*z^3 + 6*z0*z^5 - l1^4*z^2 + 2*l1^2*l2^2*z^2 + 2*l1^2*x2^2*z^2 + 2*l1^2*z^4 - l2^4*z^2 + 2*l2^2*x2^2*z^2 + 2*l2^2*z^4 - x2^4*z^2 - 2*x2^2*z^4 - z^6))/(z0^2 - 2*z0*z + x2^2 + z^2), (x2*(z0^2*x2 - 2*z0*x2*z + l1^2*x2 - l2^2*x2 + x2^3 + x2*z^2 + sqrt(-z0^6 + 6*z0^5*z + 2*z0^4*l1^2 + 2*z0^4*l2^2 - 2*z0^4*x2^2 - 15*z0^4*z^2 - 8*z0^3*l1^2*z - 8*z0^3*l2^2*z + 8*z0^3*x2^2*z + 20*z0^3*z^3 - z0^2*l1^4 + 2*z0^2*l1^2*l2^2 + 2*z0^2*l1^2*x2^2 + 12*z0^2*l1^2*z^2 - z0^2*l2^4 + 2*z0^2*l2^2*x2^2 + 12*z0^2*l2^2*z^2 - z0^2*x2^4 - 12*z0^2*x2^2*z^2 - 15*z0^2*z^4 + 2*z0*l1^4*z - 4*z0*l1^2*l2^2*z - 4*z0*l1^2*x2^2*z - 8*z0*l1^2*z^3 + 2*z0*l2^4*z - 4*z0*l2^2*x2^2*z - 8*z0*l2^2*z^3 + 2*z0*x2^4*z + 8*z0*x2^2*z^3 + 6*z0*z^5 - l1^4*z^2 + 2*l1^2*l2^2*z^2 + 2*l1^2*x2^2*z^2 + 2*l1^2*z^4 - l2^4*z^2 + 2*l2^2*x2^2*z^2 + 2*l2^2*z^4 - x2^4*z^2 - 2*x2^2*z^4 - z^6))/(z0^2 - 2*z0*z + x2^2 + z^2) - z0^2 + 2*z0*z - l1^2 + l2^2 - x2^2 - z^2)/(z0 - z));
f_2 = @(x2) 180/pi*atan2(-(z0^2*x2 - 2*z0*x2*z + l1^2*x2 - l2^2*x2 + x2^3 + x2*z^2 + sqrt(-z0^6 + 6*z0^5*z + 2*z0^4*l1^2 + 2*z0^4*l2^2 - 2*z0^4*x2^2 - 15*z0^4*z^2 - 8*z0^3*l1^2*z - 8*z0^3*l2^2*z + 8*z0^3*x2^2*z + 20*z0^3*z^3 - z0^2*l1^4 + 2*z0^2*l1^2*l2^2 + 2*z0^2*l1^2*x2^2 + 12*z0^2*l1^2*z^2 - z0^2*l2^4 + 2*z0^2*l2^2*x2^2 + 12*z0^2*l2^2*z^2 - z0^2*x2^4 - 12*z0^2*x2^2*z^2 - 15*z0^2*z^4 + 2*z0*l1^4*z - 4*z0*l1^2*l2^2*z - 4*z0*l1^2*x2^2*z - 8*z0*l1^2*z^3 + 2*z0*l2^4*z - 4*z0*l2^2*x2^2*z - 8*z0*l2^2*z^3 + 2*z0*x2^4*z + 8*z0*x2^2*z^3 + 6*z0*z^5 - l1^4*z^2 + 2*l1^2*l2^2*z^2 + 2*l1^2*x2^2*z^2 + 2*l1^2*z^4 - l2^4*z^2 + 2*l2^2*x2^2*z^2 + 2*l2^2*z^4 - x2^4*z^2 - 2*x2^2*z^4 - z^6))/(2*(z0^2 - 2*z0*z + x2^2 + z^2)) + x2, (x2*(z0^2*x2 - 2*z0*x2*z + l1^2*x2 - l2^2*x2 + x2^3 + x2*z^2 + sqrt(-z0^6 + 6*z0^5*z + 2*z0^4*l1^2 + 2*z0^4*l2^2 - 2*z0^4*x2^2 - 15*z0^4*z^2 - 8*z0^3*l1^2*z - 8*z0^3*l2^2*z + 8*z0^3*x2^2*z + 20*z0^3*z^3 - z0^2*l1^4 + 2*z0^2*l1^2*l2^2 + 2*z0^2*l1^2*x2^2 + 12*z0^2*l1^2*z^2 - z0^2*l2^4 + 2*z0^2*l2^2*x2^2 + 12*z0^2*l2^2*z^2 - z0^2*x2^4 - 12*z0^2*x2^2*z^2 - 15*z0^2*z^4 + 2*z0*l1^4*z - 4*z0*l1^2*l2^2*z - 4*z0*l1^2*x2^2*z - 8*z0*l1^2*z^3 + 2*z0*l2^4*z - 4*z0*l2^2*x2^2*z - 8*z0*l2^2*z^3 + 2*z0*x2^4*z + 8*z0*x2^2*z^3 + 6*z0*z^5 - l1^4*z^2 + 2*l1^2*l2^2*z^2 + 2*l1^2*x2^2*z^2 + 2*l1^2*z^4 - l2^4*z^2 + 2*l2^2*x2^2*z^2 + 2*l2^2*z^4 - x2^4*z^2 - 2*x2^2*z^4 - z^6))/(z0^2 - 2*z0*z + x2^2 + z^2) + z0^2 - 2*z0*z - l1^2 + l2^2 - x2^2 + z^2)/(2*(z0 - z)));

subplot(2,1,1)
fplot(f_1, [0, 149])
title('beta')

subplot(2,1,2)
fplot(f_2, [0, 149])
title('gamma')

%fmesh(f, [0, 80, 0, 10]);