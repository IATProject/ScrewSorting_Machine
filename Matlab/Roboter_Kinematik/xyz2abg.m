function [alpha, beta, gamma] = xyz2abg(x,y,z)

[x_, z_, alpha] = xyz2xza(x,y,z); % rad

z0 = 58;
l1 = 80;
l2 = 80;

% Avoid singularity
delta = 0.001;
if z_ > z0-delta && z_< z0+delta
    z_ = z0+delta;
end

if(z<58)
    beta = atan2((z0^2*x_ - 2*z0*x_*z_ + l1^2*x_ - l2^2*x_ + x_^3 + x_*z_^2 + sqrt(-z0^6 + 6*z0^5*z_ + 2*z0^4*l1^2 + 2*z0^4*l2^2 - 2*z0^4*x_^2 - 15*z0^4*z_^2 - 8*z0^3*l1^2*z_ - 8*z0^3*l2^2*z_ + 8*z0^3*x_^2*z_ + 20*z0^3*z_^3 - z0^2*l1^4 + 2*z0^2*l1^2*l2^2 + 2*z0^2*l1^2*x_^2 + 12*z0^2*l1^2*z_^2 - z0^2*l2^4 + 2*z0^2*l2^2*x_^2 + 12*z0^2*l2^2*z_^2 - z0^2*x_^4 - 12*z0^2*x_^2*z_^2 - 15*z0^2*z_^4 + 2*z0*l1^4*z_ - 4*z0*l1^2*l2^2*z_ - 4*z0*l1^2*x_^2*z_ - 8*z0*l1^2*z_^3 + 2*z0*l2^4*z_ - 4*z0*l2^2*x_^2*z_ - 8*z0*l2^2*z_^3 + 2*z0*x_^4*z_ + 8*z0*x_^2*z_^3 + 6*z0*z_^5 - l1^4*z_^2 + 2*l1^2*l2^2*z_^2 + 2*l1^2*x_^2*z_^2 + 2*l1^2*z_^4 - l2^4*z_^2 + 2*l2^2*x_^2*z_^2 + 2*l2^2*z_^4 - x_^4*z_^2 - 2*x_^2*z_^4 - z_^6))/(z0^2 - 2*z0*z_ + x_^2 + z_^2), (x_*(z0^2*x_ - 2*z0*x_*z_ + l1^2*x_ - l2^2*x_ + x_^3 + x_*z_^2 + sqrt(-z0^6 + 6*z0^5*z_ + 2*z0^4*l1^2 + 2*z0^4*l2^2 - 2*z0^4*x_^2 - 15*z0^4*z_^2 - 8*z0^3*l1^2*z_ - 8*z0^3*l2^2*z_ + 8*z0^3*x_^2*z_ + 20*z0^3*z_^3 - z0^2*l1^4 + 2*z0^2*l1^2*l2^2 + 2*z0^2*l1^2*x_^2 + 12*z0^2*l1^2*z_^2 - z0^2*l2^4 + 2*z0^2*l2^2*x_^2 + 12*z0^2*l2^2*z_^2 - z0^2*x_^4 - 12*z0^2*x_^2*z_^2 - 15*z0^2*z_^4 + 2*z0*l1^4*z_ - 4*z0*l1^2*l2^2*z_ - 4*z0*l1^2*x_^2*z_ - 8*z0*l1^2*z_^3 + 2*z0*l2^4*z_ - 4*z0*l2^2*x_^2*z_ - 8*z0*l2^2*z_^3 + 2*z0*x_^4*z_ + 8*z0*x_^2*z_^3 + 6*z0*z_^5 - l1^4*z_^2 + 2*l1^2*l2^2*z_^2 + 2*l1^2*x_^2*z_^2 + 2*l1^2*z_^4 - l2^4*z_^2 + 2*l2^2*x_^2*z_^2 + 2*l2^2*z_^4 - x_^4*z_^2 - 2*x_^2*z_^4 - z_^6))/(z0^2 - 2*z0*z_ + x_^2 + z_^2) - z0^2 + 2*z0*z_ - l1^2 + l2^2 - x_^2 - z_^2)/(z0 - z_));
    gamma = atan2(-(z0^2*x_ - 2*z0*x_*z_ + l1^2*x_ - l2^2*x_ + x_^3 + x_*z_^2 + sqrt(-z0^6 + 6*z0^5*z_ + 2*z0^4*l1^2 + 2*z0^4*l2^2 - 2*z0^4*x_^2 - 15*z0^4*z_^2 - 8*z0^3*l1^2*z_ - 8*z0^3*l2^2*z_ + 8*z0^3*x_^2*z_ + 20*z0^3*z_^3 - z0^2*l1^4 + 2*z0^2*l1^2*l2^2 + 2*z0^2*l1^2*x_^2 + 12*z0^2*l1^2*z_^2 - z0^2*l2^4 + 2*z0^2*l2^2*x_^2 + 12*z0^2*l2^2*z_^2 - z0^2*x_^4 - 12*z0^2*x_^2*z_^2 - 15*z0^2*z_^4 + 2*z0*l1^4*z_ - 4*z0*l1^2*l2^2*z_ - 4*z0*l1^2*x_^2*z_ - 8*z0*l1^2*z_^3 + 2*z0*l2^4*z_ - 4*z0*l2^2*x_^2*z_ - 8*z0*l2^2*z_^3 + 2*z0*x_^4*z_ + 8*z0*x_^2*z_^3 + 6*z0*z_^5 - l1^4*z_^2 + 2*l1^2*l2^2*z_^2 + 2*l1^2*x_^2*z_^2 + 2*l1^2*z_^4 - l2^4*z_^2 + 2*l2^2*x_^2*z_^2 + 2*l2^2*z_^4 - x_^4*z_^2 - 2*x_^2*z_^4 - z_^6))/(2*(z0^2 - 2*z0*z_ + x_^2 + z_^2)) + x_, (x_*(z0^2*x_ - 2*z0*x_*z_ + l1^2*x_ - l2^2*x_ + x_^3 + x_*z_^2 + sqrt(-z0^6 + 6*z0^5*z_ + 2*z0^4*l1^2 + 2*z0^4*l2^2 - 2*z0^4*x_^2 - 15*z0^4*z_^2 - 8*z0^3*l1^2*z_ - 8*z0^3*l2^2*z_ + 8*z0^3*x_^2*z_ + 20*z0^3*z_^3 - z0^2*l1^4 + 2*z0^2*l1^2*l2^2 + 2*z0^2*l1^2*x_^2 + 12*z0^2*l1^2*z_^2 - z0^2*l2^4 + 2*z0^2*l2^2*x_^2 + 12*z0^2*l2^2*z_^2 - z0^2*x_^4 - 12*z0^2*x_^2*z_^2 - 15*z0^2*z_^4 + 2*z0*l1^4*z_ - 4*z0*l1^2*l2^2*z_ - 4*z0*l1^2*x_^2*z_ - 8*z0*l1^2*z_^3 + 2*z0*l2^4*z_ - 4*z0*l2^2*x_^2*z_ - 8*z0*l2^2*z_^3 + 2*z0*x_^4*z_ + 8*z0*x_^2*z_^3 + 6*z0*z_^5 - l1^4*z_^2 + 2*l1^2*l2^2*z_^2 + 2*l1^2*x_^2*z_^2 + 2*l1^2*z_^4 - l2^4*z_^2 + 2*l2^2*x_^2*z_^2 + 2*l2^2*z_^4 - x_^4*z_^2 - 2*x_^2*z_^4 - z_^6))/(z0^2 - 2*z0*z_ + x_^2 + z_^2) + z0^2 - 2*z0*z_ - l1^2 + l2^2 - x_^2 + z_^2)/(2*(z0 - z_)));
else
    beta = atan2(-(-z0^2*x_ + 2*z0*x_*z_ - l1^2*x_ + l2^2*x_ - x_^3 - x_*z_^2 + sqrt(-z0^6 + 6*z0^5*z_ + 2*z0^4*l1^2 + 2*z0^4*l2^2 - 2*z0^4*x_^2 - 15*z0^4*z_^2 - 8*z0^3*l1^2*z_ - 8*z0^3*l2^2*z_ + 8*z0^3*x_^2*z_ + 20*z0^3*z_^3 - z0^2*l1^4 + 2*z0^2*l1^2*l2^2 + 2*z0^2*l1^2*x_^2 + 12*z0^2*l1^2*z_^2 - z0^2*l2^4 + 2*z0^2*l2^2*x_^2 + 12*z0^2*l2^2*z_^2 - z0^2*x_^4 - 12*z0^2*x_^2*z_^2 - 15*z0^2*z_^4 + 2*z0*l1^4*z_ - 4*z0*l1^2*l2^2*z_ - 4*z0*l1^2*x_^2*z_ - 8*z0*l1^2*z_^3 + 2*z0*l2^4*z_ - 4*z0*l2^2*x_^2*z_ - 8*z0*l2^2*z_^3 + 2*z0*x_^4*z_ + 8*z0*x_^2*z_^3 + 6*z0*z_^5 - l1^4*z_^2 + 2*l1^2*l2^2*z_^2 + 2*l1^2*x_^2*z_^2 + 2*l1^2*z_^4 - l2^4*z_^2 + 2*l2^2*x_^2*z_^2 + 2*l2^2*z_^4 - x_^4*z_^2 - 2*x_^2*z_^4 - z_^6))/(2*(z0^2 - 2*z0*z_ + x_^2 + z_^2)), (-x_*(-z0^2*x_ + 2*z0*x_*z_ - l1^2*x_ + l2^2*x_ - x_^3 - x_*z_^2 + sqrt(-z0^6 + 6*z0^5*z_ + 2*z0^4*l1^2 + 2*z0^4*l2^2 - 2*z0^4*x_^2 - 15*z0^4*z_^2 - 8*z0^3*l1^2*z_ - 8*z0^3*l2^2*z_ + 8*z0^3*x_^2*z_ + 20*z0^3*z_^3 - z0^2*l1^4 + 2*z0^2*l1^2*l2^2 + 2*z0^2*l1^2*x_^2 + 12*z0^2*l1^2*z_^2 - z0^2*l2^4 + 2*z0^2*l2^2*x_^2 + 12*z0^2*l2^2*z_^2 - z0^2*x_^4 - 12*z0^2*x_^2*z_^2 - 15*z0^2*z_^4 + 2*z0*l1^4*z_ - 4*z0*l1^2*l2^2*z_ - 4*z0*l1^2*x_^2*z_ - 8*z0*l1^2*z_^3 + 2*z0*l2^4*z_ - 4*z0*l2^2*x_^2*z_ - 8*z0*l2^2*z_^3 + 2*z0*x_^4*z_ + 8*z0*x_^2*z_^3 + 6*z0*z_^5 - l1^4*z_^2 + 2*l1^2*l2^2*z_^2 + 2*l1^2*x_^2*z_^2 + 2*l1^2*z_^4 - l2^4*z_^2 + 2*l2^2*x_^2*z_^2 + 2*l2^2*z_^4 - x_^4*z_^2 - 2*x_^2*z_^4 - z_^6))/(z0^2 - 2*z0*z_ + x_^2 + z_^2) - z0^2 + 2*z0*z_ - l1^2 + l2^2 - x_^2 - z_^2)/(2*(z0 - z_)));
    gamma = atan2((-z0^2*x_ + 2*z0*x_*z_ - l1^2*x_ + l2^2*x_ - x_^3 - x_*z_^2 + sqrt(-z0^6 + 6*z0^5*z_ + 2*z0^4*l1^2 + 2*z0^4*l2^2 - 2*z0^4*x_^2 - 15*z0^4*z_^2 - 8*z0^3*l1^2*z_ - 8*z0^3*l2^2*z_ + 8*z0^3*x_^2*z_ + 20*z0^3*z_^3 - z0^2*l1^4 + 2*z0^2*l1^2*l2^2 + 2*z0^2*l1^2*x_^2 + 12*z0^2*l1^2*z_^2 - z0^2*l2^4 + 2*z0^2*l2^2*x_^2 + 12*z0^2*l2^2*z_^2 - z0^2*x_^4 - 12*z0^2*x_^2*z_^2 - 15*z0^2*z_^4 + 2*z0*l1^4*z_ - 4*z0*l1^2*l2^2*z_ - 4*z0*l1^2*x_^2*z_ - 8*z0*l1^2*z_^3 + 2*z0*l2^4*z_ - 4*z0*l2^2*x_^2*z_ - 8*z0*l2^2*z_^3 + 2*z0*x_^4*z_ + 8*z0*x_^2*z_^3 + 6*z0*z_^5 - l1^4*z_^2 + 2*l1^2*l2^2*z_^2 + 2*l1^2*x_^2*z_^2 + 2*l1^2*z_^4 - l2^4*z_^2 + 2*l2^2*x_^2*z_^2 + 2*l2^2*z_^4 - x_^4*z_^2 - 2*x_^2*z_^4 - z_^6))/(2*(z0^2 - 2*z0*z_ + x_^2 + z_^2)) + x_, (-x_*(-z0^2*x_ + 2*z0*x_*z_ - l1^2*x_ + l2^2*x_ - x_^3 - x_*z_^2 + sqrt(-z0^6 + 6*z0^5*z_ + 2*z0^4*l1^2 + 2*z0^4*l2^2 - 2*z0^4*x_^2 - 15*z0^4*z_^2 - 8*z0^3*l1^2*z_ - 8*z0^3*l2^2*z_ + 8*z0^3*x_^2*z_ + 20*z0^3*z_^3 - z0^2*l1^4 + 2*z0^2*l1^2*l2^2 + 2*z0^2*l1^2*x_^2 + 12*z0^2*l1^2*z_^2 - z0^2*l2^4 + 2*z0^2*l2^2*x_^2 + 12*z0^2*l2^2*z_^2 - z0^2*x_^4 - 12*z0^2*x_^2*z_^2 - 15*z0^2*z_^4 + 2*z0*l1^4*z_ - 4*z0*l1^2*l2^2*z_ - 4*z0*l1^2*x_^2*z_ - 8*z0*l1^2*z_^3 + 2*z0*l2^4*z_ - 4*z0*l2^2*x_^2*z_ - 8*z0*l2^2*z_^3 + 2*z0*x_^4*z_ + 8*z0*x_^2*z_^3 + 6*z0*z_^5 - l1^4*z_^2 + 2*l1^2*l2^2*z_^2 + 2*l1^2*x_^2*z_^2 + 2*l1^2*z_^4 - l2^4*z_^2 + 2*l2^2*x_^2*z_^2 + 2*l2^2*z_^4 - x_^4*z_^2 - 2*x_^2*z_^4 - z_^6))/(z0^2 - 2*z0*z_ + x_^2 + z_^2) + z0^2 - 2*z0*z_ - l1^2 + l2^2 - x_^2 + z_^2)/(2*(z0 - z_)));
end

alpha = real(alpha)*180/pi;
beta = real(beta)*180/pi;
gamma = real(gamma)*180/pi;

end